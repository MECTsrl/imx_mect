--- arch/arm/plat-mxc/include/mach/gpio.h	2010-08-20 20:55:55.000000000 +0200
+++ arch/arm/plat-mxc/include/mach/gpio.h	2012-05-12 14:26:04.683670058 +0200
@@ -37,7 +37,10 @@
 	int virtual_irq_start;
 	struct gpio_chip chip;
 	u32 both_edges;
-	spinlock_t lock;
+	ipipe_spinlock_t lock;
+#ifdef CONFIG_IPIPE
+	unsigned nonroot_gpios;
+#endif /* CONFIG_IPIPE */
 };
 
 int mxc_gpio_init(struct mxc_gpio_port*, int);
