--- ltib/dist/lfs-5.1/mysql/mysql.spec	2013-01-09 04:58:38.000000000 +0100
+++ ltib.new/dist/lfs-5.1/mysql/mysql.spec	2015-10-12 10:46:10.834464000 +0200
@@ -13,6 +13,17 @@
 Patch1          : mysql-4.1.12-gcc-4.2.patch
 BuildRoot       : %{_tmppath}/%{name}
 Prefix          : %{pfx}
+AutoReqProv     : no
+
+
+%Package rfs
+Summary         : Trimmed mysql for root file system requirements.
+Group           : Applications/File
+AutoReqProv     : no
+%Description rfs
+mysql package contents restricted to just the files that are
+needed at run time on the target.
+
 
 %Description
 %{summary}
@@ -38,18 +49,28 @@
 rm -rf $RPM_BUILD_ROOT
 mkdir -p $RPM_BUILD_ROOT/%{pfx}/%{_prefix}
 make install prefix=$RPM_BUILD_ROOT/%{pfx}/%{_prefix}
-cd $RPM_BUILD_ROOT/%{pfx}/%{_prefix}/lib/mysql
-mv $RPM_BUILD_ROOT/%{pfx}/%{_prefix}/lib/mysql/* ../
-rm mysql -rf
-rm -f $RPM_BUILD_ROOT/%{pfx}/%{_prefix}/lib/*.la
 
+cd $RPM_BUILD_ROOT/%{pfx}/%{_prefix}/lib/mysql
+mv * ..
+cd ..
+rmdir mysql
+
+cd %{_builddir}/%{name}-%{version}
+( cd $RPM_BUILD_ROOT; find .%{pfx} \( \( -not -type d \) -o \( -type d -empty \) \) -print | sed 's/^\.//' ) > all_files.lst
+sed '
+    \,^%{pfx}/usr/man, d;
+    \,^%{pfx}%{_includedir}, d;
+    \,^%{pfx}%{_prefix}/mysql-test/include, d;
+    /\.l\?a$/ d;
+' all_files.lst > rfs_files.lst
 
 %Clean
 rm -rf $RPM_BUILD_ROOT
 
 
-%Files
+%Files -f all_files.lst
 %defattr(-,root,root)
-%{pfx}/*
 
 
+%Files rfs -f rfs_files.lst
+%defattr(-,root,root)
